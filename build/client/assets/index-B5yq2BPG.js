import{r as o,j as K}from"./components-BUzCadR4.js";import{u as Ue}from"./image-DoYYkU5A.js";import{W as be,ai as fe,P as Re,S as Te,N as J,A as Ee,D as Q,aj as $,ak as Le,i as q,b as O,X as Pe,al as Ce,am as ee,C as te,l as I,Q as ke}from"./three.module-usBSO18_.js";import{c as Ve,a as ze,n as Ge}from"./style-ub7q8joN.js";import{r as _e,c as Be,a as Fe,t as je,b as re,m as He}from"./three-D7Zx43O-.js";import{m as Ie,i as We,S as Ne,H as Xe,v as Z,a as me,b as Ke,M as ne}from"./route-DD604Vix.js";import{f as Oe,c as Ye,u as ve}from"./use-reduced-motion-COWaI8BS.js";import{i as Ze,s as Je,c as Qe,m as $e,a as qe,b as et,d as tt,r as rt,e as pe,p as nt,f as at,g as st,h as it,u as ae}from"./decoder-text-CwvgDaym.js";import"./heading-DrFkACAp.js";import"./footer-bKDkjF43.js";import"./config-BVk7xxKa.js";import"./section-BKNxybaW.js";import"./useWindowSize-KpERjLL2.js";import"./link-mnOC4JC9.js";function de(e,t,n){var r;if(typeof e=="string"){let s=document;t&&(Ze(!!t.current),s=t.current),n?((r=n[e])!==null&&r!==void 0||(n[e]=s.querySelectorAll(e)),e=n[e]):e=s.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}function ot(e,t){let n;const r=()=>{const{currentTime:s}=t,v=(s===null?0:s.value)/100;n!==v&&e(v),n=v};return Oe.update(r,!0),()=>Ye(r)}const ct=Ie(()=>window.ScrollTimeline!==void 0);class he{constructor(t){this.animations=t.filter(Boolean)}then(t,n){return Promise.all(this.animations).then(t).catch(n)}getAll(t){return this.animations[0][t]}setAll(t,n){for(let r=0;r<this.animations.length;r++)this.animations[r][t]=n}attachTimeline(t){const n=this.animations.map(r=>{if(ct()&&r.attachTimeline)r.attachTimeline(t);else return r.pause(),ot(s=>{r.time=r.duration*s},t)});return()=>{n.forEach((r,s)=>{r&&r(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}stop(){this.runAll("stop")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function ut(e){return typeof e=="object"&&!Array.isArray(e)}function lt(e){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=We(e)?new Ne(t,{enableHardwareAcceleration:!1}):new Xe(t,{enableHardwareAcceleration:!0});n.mount(e),Z.set(e,n)}function ft(e,t=100){const n=Je({keyframes:[0,t],...e}),r=Math.min(Qe(n),$e);return{type:"keyframes",ease:s=>n.next(r*s).value/t,duration:qe(r)}}function se(e,t,n,r){var s;return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,e+parseFloat(t)):t==="<"?n:(s=r.get(t))!==null&&s!==void 0?s:e}const mt=(e,t,n)=>{const r=t-e;return((n-e)%r+r)%r+e};function vt(e,t){return et(e)?e[mt(0,e.length,t)]:e}function pt(e,t,n){for(let r=0;r<e.length;r++){const s=e[r];s.at>t&&s.at<n&&(rt(e,s),r--)}}function dt(e,t,n,r,s,c){pt(e,s,c);for(let v=0;v<t.length;v++)e.push({value:t[v],at:tt(s,c,r[v]),easing:vt(n,v)})}function ht(e,t){return e.at===t.at?e.value===null?1:t.value===null?-1:0:e.at-t.at}const gt="easeInOut";function yt(e,{defaultTransition:t={},...n}={},r){const s=t.duration||.3,c=new Map,v=new Map,M={},x=new Map;let E=0,A=0,T=0;for(let D=0;D<e.length;D++){const u=e[D];if(typeof u=="string"){x.set(u,A);continue}else if(!Array.isArray(u)){x.set(u.name,se(A,u.at,E,x));continue}let[U,i,a={}]=u;a.at!==void 0&&(A=se(A,a.at,E,x));let p=0;const w=(h,g,l,S=0,f=0)=>{const m=xt(h),{delay:L=0,times:d=at(m),type:G="keyframes",...H}=g;let{ease:F=t.ease||"easeOut",duration:b}=g;const C=typeof L=="function"?L(S,f):L,_=m.length;if(_<=2&&G==="spring"){let P=100;if(_===2&&St(m)){const B=m[1]-m[0];P=Math.abs(B)}const V={...H};b!==void 0&&(V.duration=it(b));const z=ft(V,P);F=z.ease,b=z.duration}b??(b=s);const k=A+C,y=k+b;d.length===1&&d[0]===0&&(d[1]=1);const R=d.length-m.length;R>0&&st(d,R),m.length===1&&m.unshift(null),dt(l,m,F,d,k,y),p=Math.max(C+b,p),T=Math.max(y,T)};if(pe(U)){const h=ie(U,v);w(i,a,oe("default",h))}else{const h=de(U,r,M),g=h.length;for(let l=0;l<g;l++){i=i,a=a;const S=h[l],f=ie(S,v);for(const m in i)w(i[m],Dt(a,m),oe(m,f),l,g)}}E=A,A+=p}return v.forEach((D,u)=>{for(const U in D){const i=D[U];i.sort(ht);const a=[],p=[],w=[];for(let g=0;g<i.length;g++){const{at:l,value:S,easing:f}=i[g];a.push(S),p.push(nt(0,T,l)),w.push(f||"easeOut")}p[0]!==0&&(p.unshift(0),a.unshift(a[0]),w.unshift(gt)),p[p.length-1]!==1&&(p.push(1),a.push(null)),c.has(u)||c.set(u,{keyframes:{},transition:{}});const h=c.get(u);h.keyframes[U]=a,h.transition[U]={...t,duration:T,ease:w,times:p,...n}}}),c}function ie(e,t){return!t.has(e)&&t.set(e,{}),t.get(e)}function oe(e,t){return t[e]||(t[e]=[]),t[e]}function xt(e){return Array.isArray(e)?e:[e]}function Dt(e,t){return e[t]?{...e,...e[t]}:{...e}}const wt=e=>typeof e=="number",St=e=>e.every(wt);function ge(e,t,n,r){const s=de(e,r),c=s.length,v=[];for(let M=0;M<c;M++){const x=s[M];Z.has(x)||lt(x);const E=Z.get(x),A={...n};typeof A.delay=="function"&&(A.delay=A.delay(M,c)),v.push(...Ke(E,{...t,transition:A},{}))}return new he(v)}const Mt=e=>Array.isArray(e)&&Array.isArray(e[0]);function At(e,t,n){const r=[];return yt(e,t,n).forEach(({keyframes:c,transition:v},M)=>{let x;pe(M)?x=me(M,c.default,v.default):x=ge(M,c,v),r.push(x)}),new he(r)}const Ut=e=>{function t(n,r,s){let c;return Mt(n)?c=At(n,r,e):ut(r)?c=ge(n,r,s,e):c=me(n,r,s),e&&e.animations.push(c),c}return t},Y=Ut(),bt={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Rt={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `},Tt="_model_fphsv_2",Et="_canvas_fphsv_11",ce={model:Tt,canvas:Et},ue={Frame:"Frame",Logo:"Logo",Screen:"Screen"},le={stiffness:40,damping:20,mass:1.4,restSpeed:.001},Xt=({models:e,show:t=!0,showDelay:n=0,cameraPosition:r={x:0,y:0,z:8},style:s,className:c,onLoad:v,alt:M,...x})=>{const[E,A]=o.useState(!1),T=o.useRef(),D=o.useRef(),u=o.useRef(),U=o.useRef(),i=o.useRef(),a=o.useRef(),p=o.useRef(),w=o.useRef(),h=o.useRef(),g=o.useRef(),l=o.useRef(),S=o.useRef(),f=o.useRef(),m=o.useRef(),L=o.useRef(),d=o.useRef(),G=o.useRef(),H=Ue(T,!1,{threshold:.2}),F=ve(),b=ae(0,le),C=ae(0,le);o.useEffect(()=>{const{clientWidth:y,clientHeight:R}=T.current;a.current=new be({canvas:D.current,alpha:!0,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),a.current.setPixelRatio(2),a.current.setSize(y,R),a.current.outputColorSpace=fe,u.current=new Re(36,y/R,.1,100),u.current.position.set(r.x,r.y,r.z),i.current=new Te,U.current=new J,i.current.add(U.current);const P=new Ee(16777215,1.2),V=new Q(16777215,1.1),z=new Q(16777215,.8);z.position.set(-6,2,2),V.position.set(.5,0,.866),L.current=[P,V,z],L.current.forEach(j=>i.current.add(j)),p.current=new J,i.current.add(p.current),p.current.position.set(0,0,-.8),p.current.rotateX(Math.PI/2);const B=512,W=8,N=8,ye=1.5,xe=.8,De=3;w.current=new $(B,B),w.current.texture.generateMipmaps=!1,h.current=new $(B,B),h.current.texture.generateMipmaps=!1;const X=new Le(W,N).rotateX(Math.PI/2),we=new q({map:w.current.texture,opacity:xe,transparent:!0});m.current=new O(X,we),m.current.scale.y=-1,p.current.add(m.current),d.current=new O(X),d.current.visible=!1,p.current.add(d.current);const Se=new q({color:16777215,opacity:0,transparent:!0});G.current=new O(X,Se),G.current.rotateX(Math.PI),G.current.position.y-=1e-5,p.current.add(G.current),g.current=new Pe(-W/2,W/2,N/2,-N/2,0,ye),g.current.rotation.x=Math.PI/2,p.current.add(g.current),l.current=new Ce,l.current.userData.darkness={value:De},l.current.onBeforeCompile=j=>{j.uniforms.darkness=l.current.userData.darkness,j.fragmentShader=`
        uniform float darkness;
        ${j.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );")}
      `},l.current.depthTest=!1,l.current.depthWrite=!1,S.current=new ee(bt),S.current.depthTest=!1,f.current=new ee(Rt),f.current.depthTest=!1;const Me=b.on("change",k),Ae=C.on("change",k);return()=>{w.current.dispose(),h.current.dispose(),_e(L.current),Be(i.current),Fe(a.current),Me(),Ae()}},[]);const _=o.useCallback(y=>{d.current.visible=!0,d.current.material=S.current,d.current.material.uniforms.tDiffuse.value=w.current.texture,S.current.uniforms.h.value=y*(1/256),a.current.setRenderTarget(h.current),a.current.render(d.current,g.current),d.current.material=f.current,d.current.material.uniforms.tDiffuse.value=h.current.texture,f.current.uniforms.v.value=y*(1/256),a.current.setRenderTarget(w.current),a.current.render(d.current,g.current),d.current.visible=!1},[]),k=o.useCallback(()=>{const R=i.current.background;i.current.background=null,i.current.overrideMaterial=l.current,a.current.setRenderTarget(w.current),a.current.render(i.current,g.current),i.current.overrideMaterial=null,_(5),_(5*.4),a.current.setRenderTarget(null),i.current.background=R,U.current.rotation.x=b.get(),U.current.rotation.y=C.get(),a.current.render(i.current,u.current)},[_,b,C]);return o.useEffect(()=>{const y=je(R=>{const{innerWidth:P,innerHeight:V}=window,z={x:(R.clientX-P/2)/P,y:(R.clientY-V/2)/V};C.set(z.x/2),b.set(z.y/2)},100);return H&&!F&&window.addEventListener("mousemove",y),()=>{window.removeEventListener("mousemove",y)}},[H,F,b,C]),o.useEffect(()=>{const y=()=>{if(!T.current)return;const{clientWidth:R,clientHeight:P}=T.current;a.current.setSize(R,P),u.current.aspect=R/P,u.current.updateProjectionMatrix(),k()};return window.addEventListener("resize",y),y(),()=>{window.removeEventListener("resize",y)}},[k]),K.jsxs("div",{className:Ve(ce.model,c),"data-loaded":E,style:ze({delay:Ge(n)},s),ref:T,role:"img","aria-label":M,...x,children:[K.jsx("canvas",{className:ce.canvas,ref:D}),e.map((y,R)=>K.jsx(Lt,{renderer:a,modelGroup:U,show:t,showDelay:n,renderFrame:k,index:R,setLoaded:A,onLoad:v,model:y},JSON.stringify(y.position)))]})},Lt=({renderer:e,model:t,modelGroup:n,renderFrame:r,index:s,showDelay:c,setLoaded:v,onLoad:M,show:x})=>{const[E,A]=o.useState(),T=ve(),D=o.createRef();o.useEffect(()=>{const u=async(i,a)=>{i.colorSpace=fe,i.flipY=!1,i.anisotropy=e.current.capabilities.getMaxAnisotropy(),i.generateMipmaps=!1,await e.current.initTexture(i),a.material.color=new te(16777215),a.material.transparent=!0,a.material.map=i};A({start:async()=>{const{texture:i,position:a,url:p}=t;let w,h;const[g,l]=await Promise.all([await re.loadAsync(i.placeholder||i.src),await He.loadAsync(p)]);n.current.add(l.scene),l.scene.traverse(async f=>{f.material&&(f.material.color=new te(2039845)),f.name===ue.Screen&&(D.current=f.clone(),D.current.material=f.material.clone(),f.parent.add(D.current),D.current.material.opacity=1,D.current.position.z+=.001,u(g,D.current),w=async()=>{const m=i.src?await re.loadAsync(i.src):g;await u(m,f),Y(1,0,{onUpdate:L=>{D.current.material.opacity=L,r()}})})});const S=new I(a.x,a.y,a.z);return T&&l.scene.position.set(...S.toArray()),t.animation===ne.SpringUp&&(h=()=>{const f=new I(S.x,S.y-1,S.z);l.scene.position.set(...f.toArray()),Y(f.y,S.y,{type:"spring",delay:(300*s+c)/1e3,stiffness:60,damping:20,mass:1,restSpeed:1e-4,restDelta:1e-4,onUpdate:m=>{l.scene.position.y=m,r()}})}),t.animation===ne.LaptopOpen&&(h=()=>{const f=l.scene.children.find(d=>d.name===ue.Frame),m=new I(ke.degToRad(90),0,0),L=new I(0,0,0);return l.scene.position.set(...S.toArray()),f.rotation.set(...m.toArray()),Y(m.x,L.x,{type:"spring",delay:(300*s+c+300)/1e3,stiffness:80,damping:20,restSpeed:1e-4,restDelta:1e-4,onUpdate:d=>{f.rotation.x=d,r()}})}),{loadFullResTexture:w,playAnimation:h}}})},[]),o.useEffect(()=>{if(!E||!x)return;let u;const U=async()=>{const{loadFullResTexture:i,playAnimation:a}=await E.start();v(!0),M==null||M(),T||(u=a()),await i(),T&&r()};return o.startTransition(()=>{U()}),()=>{u==null||u.stop()}},[E,x])};export{Xt as Model};
